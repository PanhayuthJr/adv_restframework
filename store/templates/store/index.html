{% extends 'store/base.html' %}
{% load static %}

{% block content %}
<!-- Elite Hero Slider -->
<div
    class="mb-16 relative group overflow-hidden rounded-[3rem] shadow-2xl h-[520px] bg-slate-900 border border-slate-800 fade-in">
    <!-- Progress Indicator Bar -->
    <div class="absolute top-0 left-0 w-full h-1 z-20 bg-white/10">
        <div id="sliderProgress" class="h-full bg-accent w-0 transition-all duration-[6000ms] ease-linear"></div>
    </div>

    <!-- Slides Container -->
    <div id="heroSlider" class="flex h-full transition-transform duration-1000 ease-in-out">
        <!-- Slide 1: Cyberpunk Laptop -->
        <div class="min-w-full h-full relative overflow-hidden group/slide">
            <img src="{% static 'images/cyberpunk_laptop_promo_1769459143656.png' %}"
                class="absolute inset-0 w-full h-full object-cover scale-100 group-hover/slide:scale-105 transition-transform duration-[10s]"
                alt="Tech Promotion">
            <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/60 to-transparent"></div>
            <div class="relative h-full flex flex-col justify-center px-12 md:px-24 space-y-6 max-w-4xl">
                <div class="flex items-center gap-3">
                    <span
                        class="inline-block px-4 py-1.5 bg-accent/20 border border-accent/30 text-accent text-[10px] font-black uppercase tracking-[0.3em] rounded-full">New
                        Transmission</span>
                    <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest flex items-center">
                        <i class="fas fa-microchip mr-2"></i> RTX 5090 READY
                    </span>
                </div>
                <h1 class="text-6xl md:text-8xl font-black text-white leading-tight -tracking-widest">Neon <br><span
                        class="text-accent underline decoration-8 underline-offset-4">Titan G9</span></h1>
                <p class="text-slate-300 text-lg font-medium leading-relaxed max-w-xl">Experience ultimate processing
                    dominance. Engineered for those who command the digital frontier with absolute power.</p>
                <div class="flex items-center gap-6 pt-4">
                    <a href="{% url 'store:index' %}"
                        class="bg-white text-slate-900 px-10 py-5 rounded-2xl font-black shadow-xl hover:bg-accent hover:text-white transition-all hover:-translate-y-1 active:scale-95 flex items-center gap-3">
                        Deploy Unit
                        <i class="fas fa-arrow-right-long text-xs opacity-50"></i>
                    </a>
                    <div class="flex flex-col">
                        <span class="text-slate-500 text-[10px] font-black uppercase">Initial Unit Price</span>
                        <span class="text-white font-bold text-3xl tracking-tighter">$2,499.00</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 2: Audiophile Headphones -->
        <div class="min-w-full h-full relative overflow-hidden group/slide">
            <img src="{% static 'images/audiophile_headphones_promo_1769459177658.png' %}"
                class="absolute inset-0 w-full h-full object-cover scale-100 group-hover/slide:scale-105 transition-transform duration-[10s]"
                alt="Audio Promotion">
            <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/70 to-transparent"></div>
            <div
                class="relative h-full flex flex-col justify-center px-12 md:px-24 space-y-6 max-w-4xl text-right md:ml-auto">
                <div class="flex justify-end items-center gap-4">
                    <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest">
                        <i class="fas fa-wave-square mr-2"></i> LOSSLESS REPRODUCTION
                    </span>
                    <span
                        class="inline-block px-4 py-1.5 bg-pink-500/20 border border-pink-500/30 text-pink-400 text-[10px] font-black uppercase tracking-[0.3em] rounded-full">Audiophile
                        Grade</span>
                </div>
                <h1 class="text-6xl md:text-8xl font-black text-white leading-tight -tracking-widest">Studio <br><span
                        class="text-pink-500 underline decoration-8 underline-offset-4">X-Aural</span></h1>
                <p class="text-slate-300 text-lg font-medium leading-relaxed max-w-xl ml-auto">Refined for absolute
                    sonic purity. High-fidelity drivers meet premium executive materials for the ultimate listening
                    session.</p>
                <div class="flex items-center justify-end gap-10 pt-4">
                    <div class="flex flex-col">
                        <span class="text-slate-500 text-[10px] font-black uppercase">Acquisition Cost</span>
                        <span class="text-white font-bold text-3xl tracking-tighter">$599.00</span>
                    </div>
                    <a href="{% url 'store:index' %}"
                        class="bg-pink-500 text-white px-10 py-5 rounded-2xl font-black shadow-xl hover:bg-white hover:text-slate-900 transition-all hover:-translate-y-1 active:scale-95">Pre-Order
                        Now</a>
                </div>
            </div>
        </div>

        <!-- Slide 3: Executive Keyboard -->
        <div class="min-w-full h-full relative overflow-hidden group/slide">
            <img src="{% static 'images/executive_keyboard_promo_1769459162697.png' %}"
                class="absolute inset-0 w-full h-full object-cover scale-100 group-hover/slide:scale-105 transition-transform duration-[10s]"
                alt="Input Promotion">
            <div class="absolute inset-0 bg-gradient-to-t from-slate-900/90 via-slate-900/40 to-transparent"></div>
            <div class="absolute bottom-16 inset-x-0 flex flex-col items-center text-center space-y-6">
                <div class="flex items-center gap-4">
                    <span
                        class="bg-amber-500/20 border border-amber-500/30 text-amber-500 text-[10px] font-black uppercase tracking-[0.3em] px-4 py-1.5 rounded-full">Limited
                        Run</span>
                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-widest">
                        <i class="fas fa-keyboard mr-2"></i> PURE TACTILE FEEDBACK
                    </span>
                </div>
                <h1 class="text-6xl md:text-7xl font-black text-white -tracking-tighter">The Tactile Collective <span
                        class="text-amber-500">v4</span></h1>
                <p class="text-slate-300 font-medium max-w-2xl px-6 text-lg">Luxury aesthetics meet modular precision.
                    Crafted for the modern executive workflow.</p>
                <div class="pt-4">
                    <a href="{% url 'store:index' %}"
                        class="bg-amber-500 text-white px-10 py-5 rounded-2xl font-black shadow-2xl shadow-amber-500/30 hover:bg-white hover:text-slate-900 transition-all hover:-translate-y-1 flex items-center gap-3">
                        Initialize Session
                        <i class="fas fa-bolt-lightning text-xs"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation HUD -->
    <div class="absolute bottom-8 inset-x-0 flex items-center justify-between px-12 z-20">
        <div class="flex gap-4 items-center">
            <span class="text-white font-black text-xs tabular-nums">0<span id="currentSlideNum">1</span></span>
            <div class="flex gap-2.5">
                <button onclick="goToSlide(0)"
                    class="hero-dot w-6 h-1.5 bg-white/20 rounded-full transition-all hover:bg-white active-dot"></button>
                <button onclick="goToSlide(1)"
                    class="hero-dot w-3 h-1.5 bg-white/10 rounded-full transition-all hover:bg-white"></button>
                <button onclick="goToSlide(2)"
                    class="hero-dot w-3 h-1.5 bg-white/10 rounded-full transition-all hover:bg-white"></button>
            </div>
            <span class="text-white/30 font-black text-xs">03</span>
        </div>

        <div class="flex gap-2">
            <button onclick="prevSlide()"
                class="w-12 h-12 bg-white/5 backdrop-blur-md border border-white/10 rounded-xl flex items-center justify-center text-white hover:bg-white hover:text-slate-900 transition-all">
                <i class="fas fa-arrow-left text-sm"></i>
            </button>
            <button onclick="nextSlide()"
                class="w-12 h-12 bg-white/5 backdrop-blur-md border border-white/10 rounded-xl flex items-center justify-center text-white hover:bg-white hover:text-slate-900 transition-all">
                <i class="fas fa-arrow-right text-sm"></i>
            </button>
        </div>
    </div>
</div>

<!-- Header Section -->
<div class="mb-12 flex flex-col md:flex-row md:items-end justify-between gap-6 fade-in">
    <div class="space-y-2">
        <h2 class="text-4xl md:text-5xl font-black text-slate-900 leading-tight">Elite Collection</h2>
        <p class="text-slate-500 text-lg font-medium">Discover curated products for a refined lifestyle.</p>
    </div>
    <div class="flex items-center gap-4">
        <span
            class="inline-flex items-center px-4 py-2 bg-white border border-slate-200 rounded-full text-sm font-bold shadow-sm">
            <span class="w-2 h-2 bg-accent rounded-full mr-3 animate-pulse"></span>
            {{ page_obj.paginator.count }} Products Detected
        </span>
    </div>
</div>

<style>
    @keyframes slow-zoom {
        from {
            transform: scale(1);
        }

        to {
            transform: scale(1.15);
        }
    }

    .animate-slow-zoom {
        animation: slow-zoom 20s linear infinite alternate;
    }

    .hero-dot.active-dot {
        @apply w-10 bg-white;
    }
</style>

<script>
    let currentSlide = 0;
    const totalSlides = 3;
    const heroSlider = document.getElementById('heroSlider');
    const dots = document.querySelectorAll('.hero-dot');
    const progress = document.getElementById('sliderProgress');
    const slideNum = document.getElementById('currentSlideNum');

    function startProgress() {
        progress.style.transition = 'none';
        progress.style.width = '0%';
        setTimeout(() => {
            progress.style.transition = 'width 6000ms linear';
            progress.style.width = '100%';
        }, 50);
    }

    function updateSlider() {
        heroSlider.style.transform = `translateX(-${currentSlide * 100}%)`;
        slideNum.textContent = currentSlide + 1;

        dots.forEach((dot, index) => {
            if (index === currentSlide) {
                dot.classList.add('active-dot', 'w-10');
                dot.classList.remove('w-3', 'bg-white/10');
                dot.classList.add('bg-white');
            } else {
                dot.classList.remove('active-dot', 'w-10', 'bg-white');
                dot.classList.add('w-3', 'bg-white/10');
            }
        });
        startProgress();
    }

    function nextSlide() {
        currentSlide = (currentSlide + 1) % totalSlides;
        updateSlider();
    }

    function prevSlide() {
        currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
        updateSlider();
    }

    function goToSlide(index) {
        currentSlide = index;
        updateSlider();
        clearInterval(autoSlide);
        autoSlide = setInterval(nextSlide, 6000);
    }

    // Initialize
    updateSlider();
    let autoSlide = setInterval(nextSlide, 6000);
</script>

{% if products %}
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
    {% for product in products %}
    <div
        class="group relative flex flex-col bg-white border border-slate-200 rounded-[2rem] overflow-hidden transition-all duration-500 hover:shadow-[0_32px_64px_-16px_rgba(0,0,0,0.1)] hover:-translate-y-2">
        <a href="{% url 'store:product_detail' product.id %}" class="block overflow-hidden relative aspect-[4/5]">
            {% if product.image %}
            <img src="{{ product.image.url }}"
                class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                alt="{{ product.name }}">
            {% else %}
            <div class="w-full h-full bg-slate-100 flex items-center justify-center text-slate-400">
                <i class="bi bi-image text-4xl"></i>
            </div>
            {% endif %}

            {% if product.stock == 0 %}
            <div class="absolute inset-0 bg-white/60 backdrop-blur-[2px] flex items-center justify-center">
                <span
                    class="bg-slate-900 text-white px-6 py-2 rounded-full text-xs font-black tracking-widest uppercase">
                    SOLDOUT
                </span>
            </div>
            {% endif %}

            <!-- Quick Actions Overly -->
            <div
                class="absolute top-4 right-4 translate-x-4 opacity-0 group-hover:translate-x-0 group-hover:opacity-100 transition-all duration-300">
                <a href="{% url 'store:add_to_wishlist' product.pk %}"
                    class="w-10 h-10 bg-white/90 backdrop-blur shadow-lg rounded-full flex items-center justify-center text-slate-900 hover:bg-accent hover:text-white transition-colors">
                    <i class="bi bi-heart-fill text-sm"></i>
                </a>
            </div>
        </a>

        <div class="p-6 flex flex-col flex-1">
            <div class="flex justify-between items-start mb-3">
                <div>
                    <span class="text-[10px] font-black tracking-widest text-accent uppercase mb-1 block">{{
                        product.category.name }}</span>
                    <h3 class="text-lg font-bold text-slate-900 group-hover:text-accent transition-colors line-clamp-1">
                        {{ product.name }}</h3>
                </div>
            </div>

            <div class="mt-auto pt-6 border-t border-slate-50 flex items-center justify-between">
                <span class="text-2xl font-black text-slate-900">${{ product.price }}</span>
                {% if product.stock > 0 %}
                <a href="{% url 'store:add_to_cart' product.id %}"
                    class="w-12 h-12 bg-accent text-white rounded-2xl flex items-center justify-center shadow-lg shadow-accent/20 hover:bg-slate-900 hover:shadow-xl transition-all active:scale-90">
                    <i class="bi bi-bag-plus-fill text-xl"></i>
                </a>
                {% else %}
                <button disabled
                    class="w-12 h-12 bg-slate-100 text-slate-400 rounded-2xl flex items-center justify-center cursor-not-allowed">
                    <i class="bi bi-dash-circle text-xl"></i>
                </button>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Pagination -->
{% if page_obj.has_other_pages %}
<div class="flex justify-center mt-16 pb-10">
    <nav class="flex items-center space-x-2 bg-white border border-slate-200 p-2 rounded-2xl shadow-sm">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}"
            class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-slate-100 transition-colors">
            <i class="bi bi-chevron-left text-sm"></i>
        </a>
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
        <a href="?page={{ num }}"
            class="w-10 h-10 flex items-center justify-center rounded-xl font-bold transition-all {% if page_obj.number == num %}bg-accent text-white shadow-lg shadow-accent/20{% else %}hover:bg-slate-100 text-slate-600{% endif %}">
            {{ num }}
        </a>
        {% endfor %}

        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}"
            class="w-10 h-10 flex items-center justify-center rounded-xl hover:bg-slate-100 transition-colors">
            <i class="bi bi-chevron-right text-sm"></i>
        </a>
        {% endif %}
    </nav>
</div>
{% endif %}

{% else %}
<div
    class="flex flex-col items-center justify-center py-20 bg-white border border-dashed border-slate-200 rounded-[3rem] text-center max-w-2xl mx-auto shadow-2xl shadow-slate-200/50">
    <div class="w-24 h-24 bg-slate-50 rounded-full flex items-center justify-center mb-6">
        <i class="bi bi-search text-4xl text-slate-300"></i>
    </div>
    <h3 class="text-2xl font-black text-slate-900 mb-2">No items found</h3>
    <p class="text-slate-500 mb-8 max-w-sm">We couldn't find any products matching your current filters. Try resetting
        them.</p>
    <a href="{% url 'store:index' %}"
        class="bg-accent text-white px-8 py-4 rounded-full font-bold shadow-xl shadow-accent/20 hover:shadow-accent/40 hover:-translate-y-1 transition-all">Clear
        All Filters</a>
</div>
{% endif %}
{% endblock %}